import{s,u as X,y as Y,p as c,t as m}from"./index-c511a629.js";import{p as Z,b as ee,e as te,f as se,a as ae,g as oe}from"./practice-09690c7d.js";import{b as ne}from"./icon-back-h-0fef6b27.js";import{c as ce,n as ie}from"./icon-collect-n-7dad1c8c.js";import{C as re,S as le,I as ue,Q as de,J as me,a as pe}from"./index-b294c73b.js";import"./index-fd5c4c39.js";import"./index-d3deb666.js";import"./useForceUpdate-771f503b.js";const fe="_navheader_1gd0f_1",_e="_top_1gd0f_9",r={navheader:fe,top:_e,"left-top":"_left-top_1gd0f_22","icon-back":"_icon-back_1gd0f_29","right-top":"_right-top_1gd0f_34","prev-button":"_prev-button_1gd0f_40","next-button":"_next-button_1gd0f_54","project-box":"_project-box_1gd0f_68","left-box":"_left-box_1gd0f_76","right-box":"_right-box_1gd0f_88","practice-join-box":"_practice-join-box_1gd0f_96","delete-icon":"_delete-icon_1gd0f_103","buttons-box":"_buttons-box_1gd0f_125","see-answer":"_see-answer_1gd0f_135"},he="_box_iyeuj_1",xe="_num_iyeuj_4",u={box:he,"number-box":"_number-box_iyeuj_4","active-num":"_active-num_iyeuj_13","completed-num":"_completed-num_iyeuj_28",num:xe,"number-box2":"_number-box2_iyeuj_57"},ge=({activeNum:j,qidArr:d,configkey:p,hasPracticeIds:l,change:v})=>{const x=t=>{v(t)};return s.jsxs("div",{className:u.box,children:[d.length<1e3&&s.jsx("div",{className:u["number-box"],children:d.map((t,i)=>s.jsx("div",{className:i+1===j?u["active-num"]:p[t]||l&&l.indexOf(t)!==-1?u["completed-num"]:u.num,onClick:()=>x(i+1),children:i+1},i))}),d.length>=1e3&&s.jsx("div",{className:u["number-box2"],children:d.map((t,i)=>s.jsx("div",{className:i+1===j?u["active-num"]:p[t]||l&&l.indexOf(t)!==-1?u["completed-num"]:u.num,onClick:()=>x(i+1),children:i+1},i))})]})},Qe=()=>{const j=X(),d=new URLSearchParams(Y().search),[p,l]=c.useState(!1),[v,x]=c.useState({}),[t,i]=c.useState([]),[f,q]=c.useState([]),[n,g]=c.useState(1),[y,C]=c.useState(!1),[I,w]=c.useState({}),[R,Q]=c.useState([]),[P,N]=c.useState([]),[U,S]=c.useState("对答案"),[_,A]=c.useState(!1),[O,B]=c.useState(!0),[E,be]=c.useState(Number(d.get("day"))||0),[b,je]=c.useState(Number(d.get("practiceId"))||0),[D,ve]=c.useState(Number(d.get("chapterId"))||0);c.useEffect(()=>{$()},[E,b,D]),c.useEffect(()=>{F(),A(!1),S("对答案"),H()},[n]),c.useEffect(()=>{F()},[n,f]);const $=()=>{p||(l(!0),E===1?Z(b).then(e=>{document.title=e.data.practice.name,x(e.data.practice),Q([]),i(e.data.first_question),q(e.data.qid_arr),l(!1),k(e.data.first_question);let a={};for(var o=0;o<e.data.qid_arr.length;o++)a[e.data.qid_arr[o]]=!1;w(a)}):ee(b,D).then(e=>{document.title=e.data.practice.name,x(e.data.practice),Q(e.data.has_practice_question_ids),i(e.data.first_question),q(e.data.qid_arr),l(!1),k(e.data.first_question);let a={};for(var o=0;o<e.data.qid_arr.length;o++)a[e.data.qid_arr[o]]=!1;w(a)}))},H=()=>{if(p)return;l(!0),i([]),N([]);let e=f[n-1];e&&te(b,e).then(a=>{let o=a.data.question;o.answer_content="",i(o),k(o),l(!1)})},k=e=>{se({question_id:e.id}).then(a=>{a.data.status===1?C(!0):C(!1)})},z=()=>{ae({question_id:t.id}).then(()=>{y?m.success("已取消收藏"):m.success("已收藏试题"),C(!y)})},F=()=>{document.onkeydown=e=>{let a=e||event||window.event;if(l(!1),a&&a.keyCode==37)if(n===1)m.error("没有上一题了");else{let o=n;o--,g(o)}else if(a&&a.keyCode==39)if(n===f.length)m.error("没有下一题了");else{let o=n;o++,g(o)}}},G=()=>{j(-1)},K=e=>{g(e)},L=()=>{let e=f[n-1],a=I;a[e]=!0,w(a);let o=_;S(o===!0?"对答案":"收起答案"),A(!o),o||oe(b,e,{answer:P}).then(T=>{})},M=()=>{if(O&&m.info("可通过键盘← →方向键快速切题哦！"),!p){if(n===1)m.error("没有上一题了");else{let e=n;e--,g(e)}B(!1)}},V=()=>{if(O&&m.info("可通过键盘← →方向键快速切题哦！"),!p){if(n===f.length)m.error("没有下一题了");else{let e=n;e++,g(e)}B(!1)}},h=(e,a,o)=>{if(t&&t.type===6){let T=e.split("-"),W=parseInt(T[2]),J=[...P];J[W]=a,N(J)}else N(a);t&&(t.type===1||t.type===5)&&L()};return s.jsxs("div",{className:"full-container",children:[s.jsx("div",{className:r.navheader,children:s.jsxs("div",{className:r.top,children:[s.jsxs("div",{className:r["left-top"],onClick:()=>G(),children:[s.jsx("img",{className:r["icon-back"],src:ne}),v.name]}),s.jsxs("div",{className:r["right-top"],children:[s.jsx("div",{className:r["prev-button"],onClick:()=>M(),children:"上一题"}),s.jsx("div",{className:r["next-button"],onClick:()=>V(),children:"下一题"})]})]})}),s.jsxs("div",{className:r["project-box"],children:[s.jsx("div",{className:r["left-box"],children:f&&s.jsx(ge,{activeNum:n,qidArr:f,configkey:I,hasPracticeIds:R,change:e=>K(e)})}),s.jsxs("div",{className:r["right-box"],children:[v&&t&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:r["delete-icon"],onClick:()=>z(),children:[y&&s.jsxs(s.Fragment,{children:[s.jsx("img",{src:ce}),s.jsx("strong",{children:"已收藏"})]}),!y&&s.jsxs(s.Fragment,{children:[s.jsx("img",{src:ie}),"收藏试题"]})]}),s.jsxs("div",{className:r["practice-join-box"],children:[t.type===1&&s.jsx(re,{num:n,question:t,reply:null,score:t.score,isCorrect:0,isOver:_,wrongBook:!0,update:(e,a,o)=>{h(e,a)}},t.id),t.type===2&&s.jsx(le,{num:n,question:t,reply:"",score:t.score,isCorrect:0,isOver:_,wrongBook:!0,update:(e,a,o)=>{h(e,a)}},t.id),t.type===3&&s.jsx(ue,{num:n,question:t,reply:"",score:t.score,isCorrect:0,isOver:_,wrongBook:!0,update:(e,a,o)=>{h(e,a)}},t.id),t.type===4&&s.jsx(de,{num:n,question:t,reply:null,score:t.score,isCorrect:0,thumbs:[],isOver:_,showImage:!1,wrongBook:!0,update:(e,a,o)=>{h(e,a)}},t.id),t.type===5&&s.jsx(me,{num:n,question:t,reply:null,score:t.score,isCorrect:0,isOver:_,wrongBook:!0,update:(e,a,o)=>{h(e,a)}},t.id),t.type===6&&s.jsx(pe,{num:n,question:t,reply:null,score:t.score,isCorrect:0,isOver:_,wrongBook:!0,showImage:!1,update:(e,a,o)=>{h(e,a)}},t.id)]})]}),t&&(t.type===2||t.type===3||t.type===4||t.type===6)&&s.jsx("div",{className:r["buttons-box"],children:s.jsx("div",{className:r["see-answer"],onClick:()=>L(),children:U})})]})]})]})};export{Qe as default};
