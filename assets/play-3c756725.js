import{s as n,u as ee,y as te,p as i,t as b,a2 as se}from"./index-bc9ff81c.js";import{d as oe,o as ne,n as ae,r as re,q as ie}from"./wrongbook-8b96dfc6.js";import{b as ce}from"./icon-back-h-0fef6b27.js";import{C as le,S as de,I as ue,Q as me,J as he,a as ge}from"./index-175b5838.js";import{F as pe}from"./index-598de676.js";import"./index-c98cdc2b.js";import"./index-0e49bc26.js";import"./useForceUpdate-4c0917fe.js";const fe="_navheader_g3oy0_1",xe="_top_g3oy0_9",c={navheader:fe,top:xe,"left-top":"_left-top_g3oy0_22","icon-back":"_icon-back_g3oy0_29","right-top":"_right-top_g3oy0_34","prev-button":"_prev-button_g3oy0_40","next-button":"_next-button_g3oy0_54","filter-two-class":"_filter-two-class_g3oy0_68","project-box":"_project-box_g3oy0_80","left-box":"_left-box_g3oy0_89","right-box":"_right-box_g3oy0_101","wrongbook-join-box":"_wrongbook-join-box_g3oy0_109","delete-icon":"_delete-icon_g3oy0_116","buttons-box":"_buttons-box_g3oy0_129","see-answer":"_see-answer_g3oy0_139"},be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAY1BMVEUAAABWVmhWVmdWVmdWVmZXV2lXV2dWVmZWVmhVVWdVVWdVVWdWVmdVVWZYWGhVVWZVVWZVVWZWVmZgYHBhYXtVVWdVVWdWVmdWVmZWVmhXV2hWVmZWVmdYWGpZWWZVVWdVVWYH+h1OAAAAIHRSTlMASJLIjjht+i7y6b93hSTu1qtQEAfPw6CYcWdeNhsUrbNSW10AAAD3SURBVFjD7ddLjsMgEATQSmIHjAH/4/yn73/KaS9GswBhYkWKIvXbVqnEgk1DiG+g51ZRQLWzxkssr8Qpixf0lNAj22i4Xx0iKg7MiFw7rrdPRDxbjnbIdeW2RZTl6IpcR24fE9G3DQ22+FNzuy4CYWQHhGraoEaoog0qhBxt4BDhy8WF465M6rhyKRd+5VfvkbT//90yJEMyJEMyJEMy9MGh8zuGNLdOSPrhisaaQRFVIxLGhkgNWHUiIocEF3lzzI17qk+cF4oLN2SYiJ01ovxMbEIO39DCxG+RReOR5W4oydyR6dFRQvdAPu0mQxHNodAQQnzQL0XFTs4AJ1sqAAAAAElFTkSuQmCC",_e="_box_1r42j_1",ye="_num_1r42j_4",m={box:_e,"number-box":"_number-box_1r42j_4","active-num":"_active-num_1r42j_13","completed-num":"_completed-num_1r42j_28",num:ye,"number-box2":"_number-box2_1r42j_57"},je=({activeNum:V,qidArr:h,hasPracticeIds:g,change:d})=>{const t=u=>{d(u)};return n.jsxs("div",{className:m.box,children:[h.length<1e3&&n.jsx("div",{className:m["number-box"],children:h.map((u,r)=>n.jsx("div",{className:r+1===V?m["active-num"]:g[u]?m["completed-num"]:m.num,onClick:()=>t(r+1),children:r+1},r))}),h.length>=1e3&&n.jsx("div",{className:m["number-box2"],children:h.map((u,r)=>n.jsx("div",{className:r+1===V?m["active-num"]:g[u]?m["completed-num"]:m.num,onClick:()=>t(r+1),children:r+1},r))})]})},Ie=()=>{const V=ee(),h=new URLSearchParams(te().search),[g,d]=i.useState(!1),[t,u]=i.useState([]),[r,S]=i.useState([]),[F,q]=i.useState([]),[a,p]=i.useState(1),[Q,k]=i.useState([]),[O,j]=i.useState("对答案"),[f,w]=i.useState(!1),[I,E]=i.useState(!0),[C,Z]=i.useState(0),[W,G]=i.useState(0),[B,T]=i.useState({}),[N,ve]=i.useState(Number(h.get("type"))),[D,Ae]=i.useState(Number(h.get("mode"))),[L,v]=i.useState(!1);i.useEffect(()=>{P(),Y()},[N,D,C,W]),i.useEffect(()=>{X(),w(!1),j("对答案"),R()},[a]);const P=()=>{oe({question_type:N}).then(e=>{let s=e.data.categories_count,o=e.data.categories,y=0;for(let l=0;l<o.length;l++)if(o[l].name=o[l].name+"("+s[o[l].id]+")",y=y+s[o[l].id],o[l].children.length>0){let x=o[l].children;for(let A=0;A<x.length;A++)x[A].name=x[A].name+"("+s[x[A].id]+")";o[l].children.unshift({id:0,name:"全部("+s[o[l].id]+")"})}o.unshift({id:0,name:"全部("+y+")"}),q(o)})},Y=()=>{g||(d(!0),ne({type:N,cid1:C,cid2:W}).then(e=>{u(e.data.first_question),S(e.data.questions_ids),d(!1)}).catch(e=>{d(!1)}))},R=()=>{if(g)return;u([]),k([]);let e=r[a-1];e&&(d(!0),ae(e,{from:"wrongbook"}).then(s=>{let o=s.data.question;o.answer_content="",u(o),d(!1)}).catch(s=>{d(!1)}))},H=()=>{re(t.id).then(e=>{v(!1),b.success("操作成功，下次进入将不会看到该试题");let s=a,o=r;o.splice(a-1,1),S(o),s>o.length?(s--,p(s)):(w(!1),j("对答案"),R())}).catch(e=>{v(!1)})},J=()=>{v(!0)},M=()=>{let e=r[a-1],s=B;s[e]=!0,T(s);let o=f;j(o===!0?"对答案":"收起答案"),w(!o),o||ie(e,{answer:Q,from:"wrongbook"}).then(y=>{})},U=()=>{v(!1),V(-1)},X=()=>{document.onkeydown=e=>{let s=e||event||window.event;if(d(!1),s&&s.keyCode==37)if(a===1)b.error("没有上一题了");else{let o=a;o--,p(o)}else if(s&&s.keyCode==39)if(a===r.length)b.error("没有下一题了");else{let o=a;o++,p(o)}}},z=()=>{if(I&&b.info("可通过键盘← →方向键快速切题哦！"),!g){if(a===1)b.error("没有上一题了");else{let e=a;e--,p(e)}E(!1)}},K=()=>{if(I&&b.info("可通过键盘← →方向键快速切题哦！"),!g){if(a===r.length)b.error("没有下一题了");else{let e=a;e++,p(e)}E(!1)}},_=(e,s,o)=>{if(t&&t.type===6){let y=e.split("-"),l=parseInt(y[2]),x=[...Q];x[l]=s,k(x)}else k(s);t&&(t.type===1||t.type===5)&&M()},$=e=>{p(e)};return n.jsxs("div",{className:"full-container",children:[L?n.jsx(se,{title:"确认信息",centered:!0,forceRender:!0,maskClosable:!1,open:!0,width:500,onOk:()=>{H()},onCancel:()=>v(!1),children:n.jsx("div",{className:c.text,children:"是否将此题从错题本移除？"})}):null,n.jsx("div",{className:c.navheader,children:n.jsxs("div",{className:c.top,children:[n.jsxs("div",{className:c["left-top"],onClick:()=>U(),children:[n.jsx("img",{className:c["icon-back"],src:ce}),"试题错题本"]}),n.jsxs("div",{className:c["right-top"],children:[n.jsx("div",{className:c["prev-button"],onClick:()=>z(),children:"上一题"}),n.jsx("div",{className:c["next-button"],onClick:()=>K(),children:"下一题"})]})]})}),n.jsx("div",{className:c["filter-two-class"],children:n.jsx(pe,{categories:F,defaultKey:C,defaultChild:W,scenes:[],scene:"",onSelected:(e,s,o)=>{console.log(e,s),Z(e),G(s),w(!1),j("对答案"),p(1)}})}),n.jsxs("div",{className:c["project-box"],children:[n.jsx("div",{className:c["left-box"],children:r&&n.jsx(je,{activeNum:a,qidArr:r,hasPracticeIds:B,change:e=>$(e)})}),n.jsxs("div",{className:c["right-box"],children:[t&&n.jsxs(n.Fragment,{children:[t.type&&n.jsx("div",{className:c["delete-icon"],onClick:()=>J(),children:n.jsx("img",{src:be})}),n.jsxs("div",{className:c["practice-join-box"],children:[t.type===1&&n.jsx(le,{num:a,question:t,reply:null,score:t.score,isCorrect:0,isOver:f,wrongBook:!0,update:(e,s,o)=>{_(e,s)}},t.id),t.type===2&&n.jsx(de,{num:a,question:t,reply:"",score:t.score,isCorrect:0,isOver:f,wrongBook:!0,update:(e,s,o)=>{_(e,s)}},t.id),t.type===3&&n.jsx(ue,{num:a,question:t,reply:"",score:t.score,isCorrect:0,isOver:f,wrongBook:!0,update:(e,s,o)=>{_(e,s)}},t.id),t.type===4&&n.jsx(me,{num:a,question:t,reply:null,score:t.score,isCorrect:0,thumbs:[],isOver:f,showImage:!1,wrongBook:!0,update:(e,s,o)=>{_(e,s)}},t.id),t.type===5&&n.jsx(he,{num:a,question:t,reply:null,score:t.score,isCorrect:0,isOver:f,wrongBook:!0,update:(e,s,o)=>{_(e,s)}},t.id),t.type===6&&n.jsx(ge,{num:a,question:t,reply:null,score:t.score,isCorrect:0,isOver:f,wrongBook:!0,showImage:!1,update:(e,s,o)=>{_(e,s)}},t.id)]})]}),t&&(t.type===2||t.type===3||t.type===4||t.type===6)&&n.jsx("div",{className:c["buttons-box"],children:n.jsx("div",{className:c["see-answer"],onClick:()=>M(),children:O})})]})]})]})};export{Ie as default};
