import{q as K,u as O,y as U,p as i,v as A,s as t,I as G,x as J,S as d,z as T,t as Q}from"./index-d3b20173.js";import{E as V}from"./index-ce951dff.js";import{P as W}from"./Pagination-e33ebde3.js";import"./useForceUpdate-5b968ce5.js";function X(a){return K.get("/api/v3/search",a)}const Y="_input_1wxli_7",Z="_submit_1wxli_25",ee="_activeitem_1wxli_52",te="_actline_1wxli_68",se="_item_1wxli_73",ie="_contanier_1wxli_90",s={"top-content":"_top-content_1wxli_1","input-box":"_input-box_1wxli_7",input:Y,submit:Z,"type-box":"_type-box_1wxli_43",activeitem:ee,actline:te,item:se,contanier:ie,"search-box":"_search-box_1wxli_98","left-contanier":"_left-contanier_1wxli_102","search-item":"_search-item_1wxli_108","item-top":"_item-top_1wxli_114","item-content":"_item-content_1wxli_134"},le=()=>{document.title="全站搜索";const a=O(),c=new URLSearchParams(U().search),[r,x]=i.useState(!1),[l,_]=i.useState([]),[E,L]=i.useState([]),[g,P]=i.useState(!1),[h,y]=i.useState(1),[p,ne]=i.useState(10),[f,R]=i.useState(0),[k,$]=i.useState(0),[u,w]=i.useState(String(c.get("keywords"))),[m,j]=i.useState(String(c.get("keywords"))),o=A(e=>e.systemConfig.value.configFunc);i.useEffect(()=>{w(String(c.get("keywords"))),j(String(c.get("keywords")))},[c.get("keywords")]),i.useEffect(()=>{z()},[h,p,g,u]),i.useEffect(()=>{let e=[{key:0,name:"全部"},{key:"vod",name:"录播课"},{key:"video",name:"录播视频"}];o.live&&e.push({key:"live",name:"直播课"}),o.book&&e.push({key:"book",name:"电子书"}),o.topic&&e.push({key:"topic",name:"图文"}),o.paper&&e.push({key:"paper",name:"试卷"}),o.mockPaper&&e.push({key:"mock_paper",name:"模拟试卷"}),o.practice&&e.push({key:"practice",name:"练习"}),L(e)},[o]);const v=()=>{y(1),_([]),P(!g)},z=()=>{r||(x(!0),X({page:h,size:p,type:f,keywords:u}).then(e=>{_(e.data.data),$(e.data.total),x(!1)}).catch(e=>{x(!1)}))},S=()=>{if(!m){Q.error("请输入关键字后再搜索");return}a(`/search?keywords=${m}`),w(m),v()},B=e=>e==="video"?"录播视频":e==="vod"?"录播课":e==="live"?"直播课":e==="topic"?"图文":e==="book"?"电子书":e==="paper"?"试卷":e==="mock_paper"?"模拟试卷":e==="practice"?"练习":"其它",b=(e,n,N)=>{const D=e.toLowerCase(),F=n.toLowerCase(),C=D.indexOf(F),H=C>-1?e.substr(C,n.length):"",M=`<${N} style="color:#ff4d4f;">${H}</${N}>`,q=new RegExp(n,"gi");return e.replace(q,M)},I=(e,n)=>{if(e==="video")a("/courses/video/"+n);else if(e==="vod")a("/courses/detail/"+n);else if(e==="live")a("/live/detail/"+n);else if(e==="topic")a("/topic/detail/"+n);else if(e==="book")a("/book/detail/"+n);else if(e==="paper")a("/exam/papers/detail/"+n);else if(e==="mock_paper")a("/exam/mockpaper/detail/"+n);else if(e==="practice")a("/exam/practice/detail/"+n);else return};return t.jsxs("div",{className:"full-container",children:[t.jsxs("div",{className:s["top-content"],children:[t.jsxs("div",{className:s["input-box"],children:[t.jsx(G,{className:s.input,value:m,placeholder:"请输入关键字",onChange:e=>{j(e.target.value)},onPressEnter:()=>S()}),t.jsx("div",{className:s.submit,onClick:()=>S(),children:"搜索"})]}),t.jsx("div",{className:s["type-box"],children:E.map(e=>t.jsxs("div",{className:f===e.key?s.activeitem:s.item,onClick:()=>{R(e.key),v()},children:[e.name,f===e.key&&t.jsx("div",{className:s.actline})]},e.key))})]}),t.jsx("div",{className:s.contanier,children:t.jsxs("div",{className:s["search-box"],children:[r&&t.jsx(J,{children:t.jsxs("div",{className:s["left-contanier"],children:[t.jsx(d.Button,{active:!0,style:{width:800,height:18,marginTop:50}}),t.jsx(d.Button,{active:!0,style:{width:800,height:18,marginTop:60}}),t.jsx(d.Button,{active:!0,style:{width:800,height:18,marginTop:60}}),t.jsx(d.Button,{active:!0,style:{width:800,height:18,marginTop:60}})]})}),!r&&l.length===0&&t.jsx(T,{span:24,children:t.jsx(V,{})}),!r&&l.length>0&&t.jsx("div",{className:s["left-contanier"],children:l.map(e=>t.jsxs("ul",{className:s["search-item"],style:{padding:0},onClick:()=>I(e.resource_type,e.resource_id),children:[t.jsx("li",{className:s["item-top"],dangerouslySetInnerHTML:{__html:b("【"+B(e.resource_type)+"】"+e.title,u,"span")}}),e.p&&t.jsx("li",{className:s["item-content"],dangerouslySetInnerHTML:{__html:b(e.p,u,"span")}})]},e.id))}),!r&&l.length>0&&p<k&&t.jsx(T,{span:24,style:{display:"flex",justifyContent:"center",marginTop:50},children:t.jsx(W,{onChange:e=>{y(e),window.scrollTo(0,0)},pageSize:p,defaultCurrent:h,total:k})})]})})]})};export{le as default};
