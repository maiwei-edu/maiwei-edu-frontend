import{p as a,s,ah as $,al as X,I as w,an as A,D,aV as G,t as R,aW as H,u as K,aX as U,x as Y,ao as Z,z as V,a0 as I}from"./index-bc9ff81c.js";import{E as ss}from"./index-5aae9b85.js";import{N as es}from"./index-58b61523.js";import{P as ts}from"./Pagination-0364851f.js";import"./useForceUpdate-4c0917fe.js";const as="_box_1oh4z_1",is="_tit_1oh4z_26",ns="_input_1oh4z_34",cs="_title_1oh4z_94",ls="_info_1oh4z_101",os="_item_1oh4z_108",d={box:as,"right-box":"_right-box_1oh4z_8","exchange-box":"_exchange-box_1oh4z_14",tit:is,input:ns,"btn-exchange":"_btn-exchange_1oh4z_44","project-box":"_project-box_1oh4z_61","btn-title":"_btn-title_1oh4z_72","project-item":"_project-item_1oh4z_81",title:cs,info:ls,item:os},rs="_mask_1kgss_17",_s="_scaleBig_1kgss_1",ds="_rotate360_1kgss_1",hs="_info_1kgss_70",xs="_tit_1kgss_77",ms="_title_1kgss_106",x={mask:rs,"dialog-box":"_dialog-box_1kgss_31",scaleBig:_s,"dialog-tabs":"_dialog-tabs_1kgss_41","btn-close":"_btn-close_1kgss_50",rotate360:ds,"item-tab":"_item-tab_1kgss_62",info:hs,tit:xs,"project-box":"_project-box_1kgss_86","project-item":"_project-item_1kgss_94",title:ms},gs=({open:n,relateData:o,onCancel:c})=>(a.useState(!1),s.jsx(s.Fragment,{children:n&&s.jsx("div",{className:x.mask,children:s.jsxs("div",{className:x["dialog-box"],children:[s.jsxs("div",{className:x["dialog-tabs"],children:[s.jsx("div",{className:x["item-tab"],children:"兑换记录"}),s.jsx("img",{className:x["btn-close"],onClick:()=>c(),src:$})]}),s.jsx("div",{className:x.info,children:s.jsx("div",{className:x["project-box"],children:o&&o.length>0&&o.map(e=>s.jsx("div",{className:x["project-item"],children:s.jsxs("div",{className:x.title,children:[e.sign==="vod"&&s.jsxs("span",{children:["录播-",e.name]}),e.sign==="live"&&s.jsxs("span",{children:["直播-",e.name]}),e.sign==="book"&&s.jsxs("span",{children:["电子书-",e.name]}),e.sign==="paper"&&s.jsxs("span",{children:["考试-",e.name]}),e.sign==="mock_paper"&&s.jsxs("span",{children:["模拟-",e.name]}),e.sign==="practice"&&s.jsxs("span",{children:["练习-",e.name]}),e.sign==="vip"&&s.jsxs("span",{children:["VIP-",e.name]})]})},e.id))})})]})})})),bs="_mask_5n258_17",us="_scaleBig_5n258_1",ps="_rotate360_5n258_1",js="_info_5n258_70",fs="_tit_5n258_77",ks="_input_5n258_86",_={mask:bs,"dialog-box":"_dialog-box_5n258_31",scaleBig:us,"dialog-tabs":"_dialog-tabs_5n258_41","btn-close":"_btn-close_5n258_50",rotate360:ps,"item-tab":"_item-tab_5n258_62",info:js,tit:fs,"input-item":"_input-item_5n258_86",input:ks,"input-short":"_input-short_5n258_102","btn-box":"_btn-box_5n258_112","btn-cancel":"_btn-cancel_5n258_123","btn-submit":"_btn-submit_5n258_140"},vs=({open:n,status:o,exchangeCode:c,onSuccess:e,checkSuccess:b,onCancel:t})=>{const[u,h]=a.useState(!1),[m,v]=a.useState(""),[p,N]=a.useState({key:null,img:null});a.useEffect(()=>{v(""),n&&j()},[n]);const j=()=>{X().then(r=>{N(r.data)})},S=()=>{u||(h(!0),G({code:c,image_captcha:m,image_key:p.key}).then(r=>{R.success("兑换成功"),h(!1),e()}).catch(r=>{j(),h(!1)}))},y=()=>{u||(h(!0),H({code:c,image_captcha:m,image_key:p.key}).then(r=>{let k=r.data.activity.relate_courses,g=!1;for(let f=0;f<k.length;f++)k[f].is_subscribe||(g=!0);b(r.data.activity,g),h(!1)}).catch(r=>{j(),h(!1)}))};return s.jsx(s.Fragment,{children:n&&s.jsx("div",{className:_.mask,children:s.jsxs("div",{className:_["dialog-box"],children:[s.jsxs("div",{className:_["dialog-tabs"],children:[s.jsx("div",{className:_["item-tab"],children:"操作验证"}),s.jsx("img",{className:_["btn-close"],onClick:()=>t(),src:$})]}),s.jsx("div",{className:_.info,children:s.jsxs("div",{className:_["input-item"],children:[s.jsx(w,{className:_["input-short"],autoComplete:"off",placeholder:"请输入图形验证码",value:m,onChange:r=>{v(r.target.value)}}),s.jsx(A,{onClick:()=>j(),src:p.img,width:110,height:39,preview:!1,style:{cursor:"pointer"}})]})}),s.jsxs("div",{className:_["btn-box"],children:[o&&s.jsx("div",{className:_["btn-submit"],onClick:()=>S(),children:"确认"}),!o&&s.jsx(D,{loading:u,type:"primary",className:_["btn-submit"],onClick:()=>y(),children:"确认"}),s.jsx("div",{className:_["btn-cancel"],onClick:()=>t(),children:"取消"})]})]})})})},Ns="_mask_6rkhi_17",Ss="_scaleBig_6rkhi_1",ys="_rotate360_6rkhi_1",Cs="_info_6rkhi_70",zs="_tit_6rkhi_77",$s="_status_6rkhi_105",Bs="_disabled_6rkhi_139",l={mask:Ns,"dialog-box":"_dialog-box_6rkhi_31",scaleBig:Ss,"dialog-tabs":"_dialog-tabs_6rkhi_41","btn-close":"_btn-close_6rkhi_50",rotate360:ys,"item-tab":"_item-tab_6rkhi_62",info:Cs,tit:zs,"list-item":"_list-item_6rkhi_86",status:$s,"red-status":"_red-status_6rkhi_108","btn-box":"_btn-box_6rkhi_111","btn-cancel":"_btn-cancel_6rkhi_122",disabled:Bs,"btn-submit":"_btn-submit_6rkhi_155"},Es=({open:n,buttonStatus:o,data:c,onSubmit:e,onCancel:b})=>(a.useState(!1),s.jsx(s.Fragment,{children:n&&s.jsx("div",{className:l.mask,children:s.jsxs("div",{className:l["dialog-box"],children:[s.jsxs("div",{className:l["dialog-tabs"],children:[s.jsx("div",{className:l["item-tab"],children:"验证成功，可兑换以下内容"}),s.jsx("img",{className:l["btn-close"],onClick:()=>b(),src:$})]}),s.jsx("div",{className:l.info,children:c&&c.relate_courses.length>0&&c.relate_courses.map(t=>s.jsxs("div",{className:l["list-item"],children:[t.sign==="vod"&&s.jsxs("span",{children:["录播-",t.name]}),t.sign==="live"&&s.jsxs("span",{children:["直播-",t.name]}),t.sign==="book"&&s.jsxs("span",{children:["电子书-",t.name]}),t.sign==="paper"&&s.jsxs("span",{children:["考试-",t.name]}),t.sign==="mock_paper"&&s.jsxs("span",{children:["模拟-",t.name]}),t.sign==="practice"&&s.jsxs("span",{children:["练习-",t.name]}),t.sign==="vip"&&s.jsxs("span",{children:["VIP-",t.name]}),t.is_subscribe&&s.jsx("span",{className:l["red-status"],children:"已订阅"}),!t.is_subscribe&&s.jsx("span",{className:l.status,children:"未订阅"})]},t.id))}),s.jsxs("div",{className:l["btn-box"],children:[o&&s.jsx("div",{className:l["btn-submit"],onClick:()=>e(),children:"确认兑换"}),!o&&s.jsx("div",{className:l.disabled,children:"确认兑换"}),s.jsx("div",{className:l["btn-cancel"],onClick:()=>b(),children:"取消"})]})]})})})),Ls=()=>{document.title="兑换课程",K();const[n,o]=a.useState(!1),[c,e]=a.useState([]),[b,t]=a.useState(!1),[u,h]=a.useState(1),[m,v]=a.useState(10),[p,N]=a.useState(0),[j,S]=a.useState([]),[y,r]=a.useState(!1),[k,g]=a.useState(!1),[f,B]=a.useState(!1),[C,E]=a.useState(""),[P,L]=a.useState([]),[F,T]=a.useState(!1),[q,z]=a.useState(!1);a.useEffect(()=>{M()},[u,m,b]);const M=()=>{n||(o(!0),U({page:u,page_size:m}).then(i=>{e(i.data.data),N(i.data.total),o(!1)}))},J=i=>{S(i),r(!0)},O=()=>{h(1),e([]),t(!b)},Q=()=>{if(!C){R.error("请输入兑换码");return}B(!1),g(!0)};return s.jsxs("div",{className:"container",children:[s.jsx(gs,{relateData:j,open:y,onCancel:()=>r(!1)}),s.jsx(vs,{status:f,exchangeCode:C,open:k,onSuccess:()=>{E(""),g(!1),O()},checkSuccess:(i,W)=>{g(!1),L(i),T(W),z(!0)},onCancel:()=>g(!1)}),s.jsx(Es,{data:P,buttonStatus:F,open:q,onSubmit:()=>{z(!1),B(!0),g(!0)},onCancel:()=>z(!1)}),s.jsxs("div",{className:d.box,children:[s.jsx(es,{cid:15,refresh:!0}),s.jsxs("div",{className:d["right-box"],children:[s.jsxs("div",{className:d["exchange-box"],children:[s.jsx("div",{className:d.tit,children:"兑换码"}),s.jsx(w,{value:C,onChange:i=>{E(i.target.value)},className:d.input,placeholder:"请输入兑换码"}),s.jsx(D,{type:"primary",className:d["btn-exchange"],onClick:()=>Q(),children:"验证"})]}),s.jsxs("div",{className:d["project-box"],children:[s.jsx("div",{className:d["btn-title"],children:"兑换记录"}),n&&s.jsx(Y,{children:s.jsx("div",{className:"float-left d-j-flex mt-50",children:s.jsx(Z,{size:"large"})})}),!n&&c.length===0&&s.jsx(V,{span:24,children:s.jsx(ss,{})}),!n&&c.length>0&&s.jsx(s.Fragment,{children:c.map(i=>s.jsxs("div",{className:d["project-item"],onClick:()=>J(JSON.parse(i.activity.relate_data)),children:[s.jsx("div",{className:d.title,children:i.activity.name}),s.jsx("div",{className:d.info,children:s.jsx("span",{children:I(i.used_at)})})]},i.activity_id))}),!n&&c.length>0&&m<p&&s.jsx(V,{span:24,style:{display:"flex",justifyContent:"center",marginTop:50,marginBottom:30},children:s.jsx(ts,{onChange:i=>{h(i),window.scrollTo(0,0)},pageSize:m,defaultCurrent:u,total:p})})]})]})]})]})};export{Ls as default};
