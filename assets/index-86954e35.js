import{ad as S,p as t,aJ as C,s as e,x as z,ao as M,z as p,E,aK as y,aL as R,aM as w}from"./index-d3b20173.js";import{E as L}from"./index-ce951dff.js";import{N as P}from"./index-f58e9dd6.js";import{P as T}from"./Pagination-e33ebde3.js";import"./useForceUpdate-5b968ce5.js";const k="_box_h6i8h_1",A="_point_h6i8h_67",B="_cont_h6i8h_76",D="_date_h6i8h_93",a={box:k,"messages-box":"_messages-box_h6i8h_8","btn-top":"_btn-top_h6i8h_17","btn-title":"_btn-title_h6i8h_26","btn-read":"_btn-read_h6i8h_37","messages-content":"_messages-content_h6i8h_50","message-item-readed":"_message-item-readed_h6i8h_55",point:A,cont:B,date:D,"message-item":"_message-item_h6i8h_55"},I=()=>{document.title="我的消息";const f=S(),[n,l]=t.useState(!1),[i,h]=t.useState([]),[j,J]=t.useState(!1),[r,m]=t.useState(!1),[d,u]=t.useState(1),[o,K]=t.useState(20),[_,b]=t.useState(0);t.useEffect(()=>{g()},[d,o,j]);const g=()=>{n||(l(!0),C({page:d,page_size:o}).then(s=>{h(s.data.data),b(s.data.total),l(!1)}))},v=()=>{y().then(()=>{g(),m(!r),f(R(!1))})},N=(s,c)=>{s.read_at||w(s.id).then(()=>{const x=[...i];x[c].read_at=1,h(x),m(!r)})};return e.jsx("div",{className:"container",children:e.jsxs("div",{className:a.box,children:[e.jsx(P,{cid:7,refresh:r}),e.jsxs("div",{className:a["messages-box"],children:[e.jsxs("div",{className:a["btn-top"],children:[e.jsx("div",{className:a["btn-title"],children:"我的消息"}),e.jsx("div",{className:a["btn-read"],onClick:()=>v(),children:"全部已读"})]}),n&&e.jsx(z,{children:e.jsx("div",{className:"float-left d-j-flex mt-50",children:e.jsx(M,{size:"large"})})}),!n&&i.length===0&&e.jsx(p,{span:24,children:e.jsx(L,{})}),!n&&i.length>0&&e.jsx("div",{className:a["messages-content"],children:i.map((s,c)=>e.jsxs("div",{className:s.read_at?a["message-item"]:a["message-item-readed"],onClick:()=>N(s,c),children:[!s.read_at&&e.jsx("div",{className:a.point}),e.jsx("div",{className:a.cont,children:s.data.message}),e.jsx("div",{className:a.date,children:E(s.created_at)})]},s.id))}),!n&&i.length>0&&o<_&&e.jsx(p,{span:24,style:{display:"flex",justifyContent:"center",marginTop:50,marginBottom:30},children:e.jsx(T,{onChange:s=>{u(s),window.scrollTo(0,0)},pageSize:o,defaultCurrent:d,total:_,showSizeChanger:!1})})]})]})})};export{I as default};
