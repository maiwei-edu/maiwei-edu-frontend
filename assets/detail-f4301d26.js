import{u as R,F as q,p as a,v as P,s as e,S as d,D as Q,t as u}from"./index-c511a629.js";import{p as U,a as O}from"./paper-22bb8e9d.js";import{E as T}from"./index-38c52fdf.js";const z="_title_1agw5_12",A="_info_1agw5_23",G="_tit_1agw5_12",H="_records_1agw5_101",K="_red_1agw5_156",s={"banner-box":"_banner-box_1agw5_1",title:z,info:A,"info-item":"_info-item_1agw5_30","btn-box":"_btn-box_1agw5_44","join-button":"_join-button_1agw5_51","charge-button":"_charge-button_1agw5_67","vip-button":"_vip-button_1agw5_84","records-box":"_records-box_1agw5_101",tit:G,records:H,"record-item":"_record-item_1agw5_126","item-time":"_item-time_1agw5_138","item-type":"_item-type_1agw5_147",red:K,"item-pro":"_item-pro_1agw5_159","item-status":"_item-status_1agw5_171"},Z=()=>{const n=R(),m=q(),[r,h]=a.useState(!1),[i,y]=a.useState({}),[x,N]=a.useState([]),[g,S]=a.useState([]),[p,B]=a.useState(!1),[M,C]=a.useState(0),[V,E]=a.useState([]),[l,j]=a.useState(0),[F,I]=a.useState(0),[f,_]=a.useState(!1),[o,L]=a.useState(Number(m.courseId)||0),v=P(t=>t.loginUser.value.isLogin);a.useEffect(()=>{k()},[o]),a.useEffect(()=>{L(Number(m.courseId))},[m.courseId]),a.useEffect(()=>{let t=0;for(var c in x)t=t+x[c].length;I(t)},[x]);const k=()=>{r||(h(!0),U(o).then(t=>{if(document.title=t.data.paper.title,y(t.data.paper),N(t.data.questions),S(t.data.user_papers),B(t.data.can_join),C(t.data.join_count),E(t.data.required_courses),t.data.paper.try_times!==0){let c=t.data.paper.try_times-t.data.join_count;j(c)}else j(99999);h(!1)}).catch(t=>{h(!1)}))},b=t=>{if(!v){w();return}if(!f){if(p===!1){u.error("无权限参与");return}if(typeof t<"u"){if(t.status===3){u.error("请等待阅卷完成查看");return}n("/exam/papers/play?id="+o+"&pid="+t.id);return}_(!0),O(o).then(c=>{_(!1);let J=c.data.record_id;n("/exam/papers/play?id="+o+"&pid="+J)}).catch(c=>{_(!1)})}},w=()=>{let t=encodeURIComponent(window.location.pathname+window.location.search);n("/login?redirect="+t)},D=()=>{if(!v){w();return}if(i.charge===0){u.error("当前试卷无法购买");return}if(i.enabled_invite===1){u.error("当前试卷仅限邀请用户参与");return}n("/order?goods_id="+o+"&goods_type=paper&goods_charge="+i.charge+"&goods_label=试卷&goods_name="+i.title)};return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"bread-nav",children:[e.jsx("a",{onClick:()=>{n("/exam")},children:"考试练习"})," ","/",e.jsx("a",{onClick:()=>{n("/exam/papers")},children:"在线考试"})," ","/",e.jsx("span",{children:i.title})]}),e.jsxs("div",{className:s["banner-box"],children:[r&&e.jsxs("div",{style:{width:1200,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(d.Button,{active:!0,style:{width:300,height:28,marginTop:50,marginBottom:30}}),e.jsx(d.Button,{active:!0,style:{width:600,height:14,marginBottom:50}}),e.jsx(d.Button,{active:!0,style:{width:104,height:40,borderRadius:4}})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.title,children:i.title}),e.jsxs("div",{className:s.info,children:[e.jsxs("div",{className:s["info-item"],children:["总分：",i.score,"分"]}),e.jsx("i",{}),e.jsxs("div",{className:s["info-item"],children:["及格分：",i.pass_score,"分"]}),e.jsx("i",{}),e.jsxs("div",{className:s["info-item"],children:["题数：",F,"道"]}),e.jsx("i",{}),i.try_times===0&&e.jsx("div",{className:s["info-item"],children:"可考试次数：不限"}),i.try_times!==0&&e.jsxs("div",{className:s["info-item"],children:["剩余可考试次数：",l]})]}),l!==0&&e.jsx("div",{className:s["btn-box"],children:e.jsxs(e.Fragment,{children:[!p&&i.charge>0&&e.jsxs("div",{className:s["charge-button"],onClick:()=>D(),children:["购买试卷 ￥",i.charge]}),p&&l&&l!==0&&e.jsx(Q,{type:"primary",loading:f,className:s["join-button"],onClick:()=>b(void 0),children:"立即考试"})]})})]})]}),e.jsxs("div",{className:s["records-box"],children:[e.jsx("div",{className:s.tit,children:"考试记录"}),e.jsxs("div",{className:s.records,children:[r&&e.jsxs("div",{style:{width:1140,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(d.Button,{active:!0,style:{width:1140,height:14,marginBottom:30}}),e.jsx(d.Button,{active:!0,style:{width:1140,height:14,marginBottom:30}}),e.jsx(d.Button,{active:!0,style:{width:1140,height:14,marginBottom:30}})]}),!r&&g.length===0&&e.jsx(T,{}),!r&&g.length>0&&e.jsx(e.Fragment,{children:g.map(t=>e.jsxs("div",{className:s["record-item"],children:[e.jsx("div",{className:s["item-type"],children:e.jsxs(e.Fragment,{children:[t.status===2&&e.jsxs("span",{children:[t.score,"分"]}),t.status===3&&e.jsx("span",{children:"已完成"}),t.status!==2&&t.status!==3&&e.jsx("span",{className:s.red,children:"未完成"})]})}),e.jsx("div",{className:s["item-pro"],children:e.jsxs(e.Fragment,{children:[t.status===1&&e.jsx("span",{children:"考试中"}),t.status===3&&e.jsx("span",{children:"阅卷中"}),t.status===2&&e.jsx("span",{children:"已结束"})]})}),e.jsx("div",{className:s["item-status"],onClick:()=>b(t),children:e.jsxs(e.Fragment,{children:[t.status===1&&e.jsx("span",{className:s.red,children:"继续考试"}),t.status!==1&&e.jsx("span",{children:"考试详情"})]})})]},t.id))})]})]})]})};export{Z as default};
